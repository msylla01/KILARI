<div class="plan-rai-content">
    <p class="liste-plan-rai">Liste des plan-rai</p>
    <div class="btn-search-plan-rai">
        <div class="imput-search-btn">
            <small> Filtrer par Toc:</small>
            <form action="#">
                <input type="search" name="searchToc" class="form-control" placeholder="Rechercher par ticket" autocomplete="off">
                <button type="submit" class="btn btn-secondary"><i class="fas fa-search"></i></button>
            </form>
        </div>
    </div>
    <div class="content-tableau ">
        <table class="table table-hover" style="border: 1px solid #cccccc">
            <thead>
                <tr style="text-align: center;border: 1px solid #cccccc">
                    <th scope="col">#</th>
                    <th scope="col">TOC</th>
                    <th scope="col">Efficacité</th>
                    <th scope="col">Libelle</th>
                    <th scope="col">Porteur</th>
                    <th scope="col">Status</th>
                    <th scope="col">Perimetre</th>
                    <th scope="col">Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr style="text-align: center;border: 1px solid #cccccc" *ngFor="let toc of ListTocProbleme">
                    <th scope="row">#</th>
                    <td>
                        <nz-tag nzColor="processing">
                            {{ toc.Numerotocpro }}
                        </nz-tag>
                    </td>
                    <td style="border: 1px solid #cccccc;    padding: 0.4rem 0">
                        <table class="table partiale" style="border: 0px solid #cccccc">
                            <tr *ngFor="let t1 of toc.planrai">
                                <td>{{t1.Efficacite}}</td>
                            </tr>
                        </table>
                    </td>
                    <td style="border: 1px solid #cccccc;    padding: 0.4rem 0">
                        <table class="table partiale" style="border: 0px solid #cccccc">
                            <tr *ngFor="let t1 of toc.planrai">
                                <td>{{t1.Libelle}}</td>
                            </tr>
                        </table>
                    </td>
                    <td style="border: 1px solid #cccccc;    padding: 0.4rem 0">
                        <table class="table partiale" style="border: 0px solid #cccccc">
                            <tr *ngFor="let t1 of toc.planrai">
                                <td>{{t1.Porteur}}</td>
                            </tr>
                        </table>
                    </td>
                    <td style="border: 1px solid #cccccc;    padding: 0.4rem 0">
                        <table class="table partiale" style="border: 0px solid #cccccc">
                            <tr *ngFor="let t1 of toc.planrai">
                                <td>{{t1.Status}}</td>
                            </tr>
                        </table>
                    </td>
                    <td style="border: 1px solid #cccccc;    padding: 0.4rem 0">
                        <table class="table partiale" style="border: 0px solid #cccccc">
                            <tr *ngFor="let t1 of toc.planrai">
                                <td>{{t1.Perimetre}}</td>
                            </tr>
                        </table>
                    </td>
                    <td class="">
                        <button style="margin-right: 0.6rem;" (click)="showModal1(toc)" type="button" class="btn btn-secondary">
                      <i class="fa-solid fa-plus"></i>
                    </button>
                        <button (click)="showModal1(toc)" style="    margin-right: 0.6rem;" type="button" class="btn btn-danger">
                      <i class="fa fa-edit" aria-hidden="true"></i>
                    </button>
                        <button type="button" class="btn btn-success">
                      <i class="fa fa-eye" aria-hidden="true"></i>
                    </button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>


<nz-modal [(nzVisible)]="isVisibleReservation" nzWidth="1050px" [style]="{fontSize: '23px',color:'#8D191E',height:'23%'}" [nzTitle]="modalTitle" (nzOnCancel)="handleCancel()">

    <ng-template #modalTitle>
        <div class="modal-header ">
            <h5 class="modal-title " style="font-size: 25px;
      font-weight: 600;" id="exampleModalLabel ">{{titleModal}} du ticket: <span style="color: rgb(171, 171, 247);">{{defaultString}}</span><i class="fa fa-tasks " style=" font-size:1rem ; margin-left: 1rem; color: #ff7900; " aria-hidden="true "></i></h5>
            <!-- <button type="button " style="outline: none; " class="btn-close " (click)="deleStorageAndClose() "><span class="visually-hidden ">Close</span></button> -->
        </div>
    </ng-template>
    <div *nzModalContent>
        <div id="imput-content-step3">
            <div class="imput-content-step3 " style="padding: 0rem 1rem 1rem  ">
                <div class="content ">
                    <form class="form-horizontal style-form-control" [formGroup]="PasForm" (ngSubmit)="submitValed()">
                        <div formArrayName="pas">
                            <div *ngFor="let skill of pas.controls; let i=index">
                                <div [formGroupName]="i" class="class-form" style="    display: flex;
                          justify-content: space-between;
                          gap: 1rem;">

                                    <div class="rigth-div" style="width: 100%;    display: flex;
                              flex-direction: column;
                              gap: 0.8rem;    margin-top: 0rem;">
                                        <p style="    font-size: 1.3rem;
                                  font-weight: 600;
                                  margin-bottom: 0rem;
                                  color: orangered;">Plan d'action N*{{i+1}}</p>
                                        <div class="form-1 control-form" style="                        display: flex;
                                      width: 100%;
                                      gap: 2rem;">
                                            <div class=" form-group-div" style=" width: 100%">
                                                <label for="tocpr" style="    margin-bottom: 0.3rem;">Ticket oceane problème </label>
                                                <select id="inputState" class="form-control" formControlName="tocpr" name="tocpr">
                                            <option *ngFor="let d of ListTocProbleme" [value]="d.id ">{{d.Numerotocpro}}</option>
                                          </select>
                                            </div>
                                            <div class="form-group-div" style=" width: 100%">
                                                <label style="    margin-bottom: 0.3rem;">Libelle:</label>
                                                <div class="">
                                                    <input type="text" [disabled]="disableChamp" formControlName="Libelle" class="form-control">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-2 control-form" style="                        display: flex;
                                      width: 100%;
                                      gap: 2rem;">
                                            <div class="form-group-div" style=" width: 100%">
                                                <label style="    margin-bottom: 0.3rem;">Porteur:</label>
                                                <div class="">
                                                    <select class="form-select " name="Porteur " formControlName="Porteur">
                                              <option></option>
                                              <option *ngFor="let item of Porteur " [value]="item.value ">{{item.value}}</option>
                                            </select>
                                                </div>
                                            </div>
                                            <div class="form-group-div" style=" width: 100%">
                                                <label style="    margin-bottom: 0.3rem;">Périmetre:</label>
                                                <div class="">
                                                    <select id="inputState" [disabled]="disableChamp" name="Perimetre" formControlName="Perimetre" class="form-control">
                                                  <option selected>Filiale</option>
                                                  <option selected>Applicatif</option>
                                                  <option selected>DBA</option>
                                                  <option selected>Système</option>
                                                  <option selected>Environnement technique</option>
                                                  <option selected>Management</option>
                                                  <option selected>Supervision</option>
                                                  <option selected>QoS</option>
                                                  <option selected>Outils</option>
                                                  <option selected>IncidentChange</option>
                                                  <option selected>Filiale</option>
                                              </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-3 control-form" style="                        display: flex;
                                        width: 100%;
                                        gap: 2rem;">
                                            <div class="form-group-div" style=" width: 100%">
                                                <label style="    margin-bottom: 0.3rem;">Date de planification:</label>
                                                <div class="">

                                                    <input type="date" [disabled]="disableChamp" formControlName="Dateprevisionel" class="form-control">
                                                </div>
                                            </div>
                                            <div class="form-group-div" style=" width: 100%">
                                                <label style="    margin-bottom: 0.3rem;">Date f'efficacité:</label>
                                                <div class="">
                                                    <input type="date" [disabled]="disableChamp" formControlName="Dateeffective" class="form-control">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-4 control-form" style="                        display: flex;
                                          width: 100%;
                                          gap: 2rem;">
                                            <div class="form-group-div" style=" width: 100%">
                                                <label style="    margin-bottom: 0.3rem;">Status:</label>
                                                <div class="">
                                                    <select id="inputState" [disabled]="disableChamp" name="Priorite" formControlName="Status" class="form-control">
                                                <option value="0">0</option>
                                                <option value="1">1</option>
                                            </select>
                                                </div>
                                            </div>

                                            <div class="form-group-div" style=" width: 100%">
                                                <label style="    margin-bottom: 0.3rem;">Efficacite:</label>
                                                <div class="">
                                                    <select id="inputState" [disabled]="disableChamp" name="Efficacite" formControlName="Efficacite" class="form-control">
                                                  <option selected></option>
                                                  <option selected>ACTION EFFICACE</option>
                                                  <option selected>ACTION NON EFFICACE</option>
                                                  <option selected>ACTION A SURVEILLER</option>
                                              </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label style="    margin-bottom: 0.3rem;">Commentaire:</label>
                                            <div class="">
                                                <textarea [disabled]="disableChamp" formControlName="Commentaire" id=" " cols="30 " style="width: 100%;" rows="5 "></textarea>

                                            </div>
                                        </div>
                                    </div>
                                    <div style="    margin-top: 4.6rem;white-space: nowrap;">
                                        <button style="background:red;outline: none;" class="btn btn-primary " [disabled]="disableChamp" (click)="removePas(i)">
                                    <i class="fa fa-trash" aria-hidden="true"></i>
                                  </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div style="float:right ;margin-top: 1em">
                            <button class="btn btn-primary" [disabled]="PasForm.invalid" type="submit">{{tilreBtn}}</button>
                        </div>
                    </form>
                </div>

                <div class="footer-finale " style="display: flex;gap: 1rem;margin-top: 1em">
                    <button class="btn btn-primary" [disabled]="disableBtnAdd" style="background: orange;" (click)="addPas()">Ajouter un Plan d'action</button>
                    <button class=" btn btn-secondary">Annuler</button>
                </div>
            </div>
        </div>
    </div>
    <div *nzModalFooter [style]="{display:'flex',    padding: '1%', borderTop: 'none',    justifyContent: 'center',textAlign: 'center',
flexDirection: 'column'}">
        <!-- <div *ngIf="!customerModif['@id']">
        <button nz-button nzType="default" (click)="handleCancel()" [style]="{height: '39px',marginRight: '37px', color:'black', background:'white',fontWeight: '300',fontSize: '14px',border: '1px solid #dcd9d9',borderRadius: '5px'}" (click)="retour()">Retour</button>
        <button nz-button nzType="primary" [nzLoading]="LoadingDraft" [style]="{marginRight: '37px',color:'white', background:'#8D191E',fontWeight: '300',fontSize: '14px',border: 'none',borderRadius: '5px',width: '110px',
      height: '39px'}" (click)="CreateOrUpdateDraft()">Enregistrer</button>
        <button nz-button nzType="primary" [nzLoading]="LoadingNoDraft" [style]="{color:'white', background:'#2EE083',fontWeight: '300',fontSize: '14px',border: 'none',borderRadius: '5px',width: '193px',
      height: '39px'}" (click)="CreateOrUpdateNoDraft()">Confirmer et Reserver</button>
    </div>
    <div *ngIf="customerModif['@id']">
        <button nz-button nzType="primary" [nzLoading]="LoadingNoDraft" [style]="{color:'white', background:'#8D191E',fontWeight: '300',fontSize: '14px',border: 'none',borderRadius: '5px',
    height: '39px'}" (click)="updateReservation()">Sauvegarder les modifications</button>
    </div> -->
    </div>

</nz-modal>
